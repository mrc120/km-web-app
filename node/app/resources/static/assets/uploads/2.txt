import React, { useState, useEffect } from "react";
import FilesPodstService from "../../services/Files/files_podst.service"
import InputAdornment from '@mui/material/InputAdornment';
import SearchIcon from '@mui/icons-material/Search';
import TextField from '@mui/material/TextField';
import { Button, Container } from "react-bootstrap";

// import SearchBar from './utils/SearchBar.js';
import PaginationList, { getRequestParams } from "./utils/PaginationList"
import useAuth from "../../hooks/useAuth"



const ShowList_podst = () => {
  const { showAdminBoard, showFileUploadBoard, currentUser } = useAuth();

  //Jest w textfield, retrievetutorials
  const [searchText, setSearchText] = useState("");
  const [count, setCount] = useState(0);
  // const [pageSize, setPageSize] = useState(16);
  const [entries, setEntries] = useState([]);

  const [page, setPage] = useState(1);

  const [message, setMessage] = useState("");


  const handlePageChange = (e, value) => {
    setPage(value);
  }

  const params = getRequestParams(searchText, page);
  const sortedEntries = [...entries].sort((a, b) => entries.id > entries.id ? 1 : -1)

  const getShowlist_podst = () => {
    FilesPodstService.getAll(params)
      .then(response => {
        const { entries, totalPages } = response.data;
        setEntries(entries);
        setCount(totalPages);
      }).catch((e) => {
        console.log(e);
      });
  }
  

  useEffect(() => {
    getShowlist_podst();   
  }, [page]);


  //update and delete
  // const updateFile = () => {
  //   event.preventDefault();
  //   FilesPodstService.update(selectedItem2.id, selectedItem2)
  //     .then(response => {
  //       setMessage("Zaaktualizowano pozycję, za chwilę nastąpi przekierowanie...")
  //       setTimeout(() => window.location.reload(true), 2000);
  //     }).catch(e => {
  //       console.log(e);
  //     })
  // }

  // const deleteFile = (id) => {
  //   FilesPodstService.remove(id)
  //     .then(response => {
  //       console.log(response.data);
  //     }).catch(function (error) {
  //       console.log(error);
  //     });
  //   window.location.reload(true);
  // }
  return (
    <div className="content">
      <Container fluid>
        <TextField
          id="standard-basic"
          value={searchText}
          onChange={(e) => setSearchText(e.target.value)}
          type="text"
          variant="outlined"
          onKeyUp={getShowlist_podst}
          placeholder="Wyszukaj..."
          InputLabelProps={{ shrink: false }}
          InputProps={{
            style: { fontSize: 16, height: 50, width: 450, left: 299, position: "absolute", top: -73 },
            startAdornment: (
              <InputAdornment position="start" fontSize="small">
                <SearchIcon style={{ fontSize: 20, color: '#000000' }} />
              </InputAdornment>
            ),
          }}
        />

        <div className="row">
          {sortedEntries.map((poz) => {
            return (
              <div className="angry-grid">
                <div id="item-0">
                  <div className="h4u" data-id={poz.id}>{poz.title}</div><hr className="solid"></hr>
                  <div className="h5u">{poz.description}</div>
                </div>
                <div id="item-1">
                  <Button style={{ margin: '-1px 0 -1px 0px' }} className="btn form-control px-0 btn-danger border-right border-bottom border-left rounded-0"
                    onClick={() => expandModal2(poz)}>Edytuj</Button></div>
                <div id="item-2">
                  <Button style={{ margin: '-1px 0 -1px 0px' }} className="btn col-12 btn-block w-100 form-control pd-5 btn btn-danger border-right border-bottom rounded-0"
                    onClick={() => expandModal(poz)}>Usuń</Button>
                </div>
                <div id="item-3">
                  <Button style={{ margin: '-1px -1px -1px 0' }}
                    className="rounded-top-0  rounded-0 px-0" target="_blank" onClick={() => handleClick(item)}>
                    <i className="nc-icon nc-cloud-download-93 size-up-down "></i></Button>
                  <Button style={{ margin: '0 -1px 0px 0' }} className="d-flex align-items-center justify-content-center rounded-top-0  rounded-0 px-0" target="_blank" onChange={open}>
                    <i className="nc-icon nc-attach-87 size-up-down"></i>
                  </Button>
                </div>
              </div>
            )
          })
          }
        </div>
        <PaginationList count={count} page={page} handlePageChange={handlePageChange} />
      </Container>
    </div>
  );
}

export default ShowList_podst;
